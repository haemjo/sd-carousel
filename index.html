<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>LD Carousel</title>

  <style>
    :root{--bg1:#FFE3EF;--bg2:#FFD6E8;--glass:rgba(233,30,99,.06);--stroke:rgba(233,30,99,.18);--shadow:0 18px 55px rgba(233,30,99,.15);--text:#4A2040;--muted:rgba(74,32,64,.6);--accent:#E91E63;--accent2:#F06292;--radius:18px}
    *{box-sizing:border-box}
    html,body{height:100%;background:transparent !important}
    body{margin:0;font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,"Noto Sans KR",sans-serif;color:var(--text);background:transparent;display:flex;align-items:center;justify-content:center;padding:0px}
    .wrap{width:min(920px,100%);border:1px solid var(--stroke);background:#FFF4F8;border-radius:var(--radius);box-shadow:var(--shadow);overflow:hidden;position:relative}
    .head{padding:14px 16px 10px;display:flex;gap:12px;align-items:center;justify-content:space-between;border-bottom:1px solid rgba(233,30,99,.12)}
    .title{display:flex;flex-direction:column;gap:4px;min-width:0}
    .title strong{font-size:14px;letter-spacing:.2px}
    .title span{font-size:12px;color:var(--muted);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
    .controls{display:flex;gap:10px;align-items:center;flex-wrap:wrap;justify-content:flex-end}
    .chip{display:flex;align-items:center;gap:8px;padding:7px 10px;border:1px solid rgba(233,30,99,.15);background:rgba(255,255,255,.5);border-radius:999px;font-size:12px;color:var(--muted);user-select:none}
    .chip input{accent-color:var(--accent)}
    .carousel{position:relative;padding:14px}
    .viewport{overflow:hidden;border-radius:calc(var(--radius) - 4px);border:1px solid rgba(233,30,99,.15);background:rgba(255,255,255,.4);box-shadow:0 10px 25px rgba(233,30,99,.12)}
    .track{display:flex;will-change:transform;transition:transform 360ms cubic-bezier(.2,.9,.2,1)}
    .item{flex:0 0 100%;padding:10px;display:flex;justify-content:center;align-items:center}
    .frame{width:100%;aspect-ratio:16/9;border-radius:14px;overflow:hidden;position:relative;background:#1a1a1a;box-shadow:0 12px 30px rgba(233,30,99,.18)}
    .frame::after{content:"";position:absolute;inset:0;pointer-events:none;background:linear-gradient(135deg,rgba(233,30,99,.12),transparent 55%),linear-gradient(315deg,rgba(240,98,146,.1),transparent 55%);mix-blend-mode:screen;opacity:.7}
    iframe{width:100%;height:100%;border:0;display:block}
    .nav{position:absolute;top:50%;transform:translateY(-50%);z-index:10;width:44px;height:44px;border-radius:999px;border:1px solid rgba(233,30,99,.2);background:rgba(255,255,255,.85);color:#E91E63;cursor:pointer;display:grid;place-items:center;box-shadow:0 10px 25px rgba(233,30,99,.15);transition:transform .15s ease,background .15s ease;user-select:none}
    .nav:hover{background:rgba(255,255,255,.95);transform:translateY(-50%) scale(1.04)}
    .nav:active{transform:translateY(-50%) scale(.98)}
    .prev{left:16px}
    .next{right:16px}
    .nav svg{width:18px;height:18px}
    .dots{display:flex;justify-content:center;gap:9px;padding:12px 0 4px}
    .dot{width:8px;height:8px;border-radius:999px;background:rgba(233,30,99,.2);border:1px solid rgba(233,30,99,.15);cursor:pointer;transition:transform .15s ease,background .15s ease,width .15s ease}
    .dot.active{background:linear-gradient(90deg,var(--accent),var(--accent2));border-color:rgba(233,30,99,.3);width:18px}
    .thumbs{display:flex;gap:10px;padding:10px 6px 2px;overflow-x:auto;justify-content:center;scrollbar-width:none}
    .thumbs::-webkit-scrollbar{display:none}
    .thumb{width:120px;aspect-ratio:16/9;border-radius:12px;overflow:hidden;border:1px solid rgba(233,30,99,.15);background:rgba(255,255,255,.3);cursor:pointer;position:relative;transition:transform .15s ease,border-color .15s ease,opacity .15s ease;opacity:.72;flex:0 0 auto;box-shadow:0 10px 22px rgba(233,30,99,.12);padding:0}
    .thumb:hover{transform:translateY(-2px);opacity:.92}
    .thumb.active{opacity:1;border-color:rgba(233,30,99,.5);box-shadow:0 14px 28px rgba(233,30,99,.18)}
    .thumb img{width:100%;height:100%;object-fit:cover;display:block}
    .thumb.active::after{content:"";position:absolute;inset:0;pointer-events:none;box-shadow:inset 0 0 0 2px rgba(233,30,99,.35);border-radius:12px}
    .foot{padding:0 16px 14px;color:var(--muted);font-size:12px;display:flex;justify-content:space-between;gap:10px;flex-wrap:wrap}
    .kbd{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono",monospace;background:rgba(255,255,255,.5);border:1px solid rgba(233,30,99,.15);padding:2px 6px;border-radius:6px;color:var(--text)}
    @media (max-width:520px){.nav{width:40px;height:40px}.prev{left:10px}.next{right:10px}.carousel{padding:12px}.item{padding:8px}.thumb{width:96px;border-radius:10px}}

  </style>
</head>

<body>
  <div class="wrap" id="app">
    <div class="head">
      <div class="title" style="margin: 0 auto; text-align: center; flex: 1;">
        <strong>LD 샘플</strong>
      </div>

      <div class="controls">
      </div>
    </div>

    <div class="carousel" aria-label="YouTube carousel">
      <button class="nav prev" type="button" aria-label="이전">
        <svg viewBox="0 0 24 24" fill="none"><path d="M15 6l-6 6 6 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
      </button>

      <div class="viewport">
        <div class="track" aria-live="polite"></div>
      </div>

      <button class="nav next" type="button" aria-label="다음">
        <svg viewBox="0 0 24 24" fill="none"><path d="M9 6l6 6-6 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
      </button>

      <div class="dots" aria-label="페이지 표시"></div>
      <div class="thumbs" aria-label="썸네일 목록"></div>
    </div>
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      // ✅ 여기만 수정하면 전부 자동 적용됩니다 (URL 또는 ID 가능)
      const VIDEOS = [
        "https://www.youtube.com/watch?v=unRpvJET3I0",
        "https://www.youtube.com/watch?v=ZKl2kqy1938",
        "https://www.youtube.com/watch?v=I5IT5vOsoEs",
        "https://www.youtube.com/watch?v=e5i0cTVEHIs"
      ];

      const app = document.getElementById("app");
      const viewport = app.querySelector(".viewport");
      const track = app.querySelector(".track");
      const prevBtn = app.querySelector(".prev");
      const nextBtn = app.querySelector(".next");
      const dotsWrap = app.querySelector(".dots");
      const thumbsWrap = app.querySelector(".thumbs");
      const autoPlayEl = document.getElementById("autoPlay");
      const intervalEl = document.getElementById("interval");

      // 유튜브 ID 추출 (watch?v= / youtu.be / embed / raw id 지원)
      const toId = (v) => {
        if (!v) return "";
        const s = String(v).trim();
        if (/^[a-zA-Z0-9_-]{11}$/.test(s)) return s;
        const m1 = s.match(/[?&]v=([a-zA-Z0-9_-]{11})/);
        if (m1) return m1[1];
        const m2 = s.match(/youtu\.be\/([a-zA-Z0-9_-]{11})/);
        if (m2) return m2[1];
        const m3 = s.match(/embed\/([a-zA-Z0-9_-]{11})/);
        if (m3) return m3[1];
        return "";
      };

      const ids = VIDEOS.map(toId).filter(Boolean);
      const N = ids.length;

      if (N === 0) {
        track.innerHTML = '<div style="padding:24px;color:#4A2040;">영상 주소/ID를 확인해주세요.</div>';
        return;
      }

      // 슬라이드 DOM 자동 생성
      const makeSlide = (id, i) => {
        const item = document.createElement("div");
        item.className = "item";
        item.innerHTML =
          `<div class="frame"><iframe src="https://www.youtube.com/embed/${id}?rel=0&modestbranding=1" title="LD ${i+1}" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe></div>`;
        return item;
      };

      track.innerHTML = "";
      ids.forEach((id, i) => track.appendChild(makeSlide(id, i)));

      // 무한루프용 clone
      const originals = Array.from(track.children);
      const firstClone = originals[0].cloneNode(true);
      const lastClone  = originals[N - 1].cloneNode(true);
      track.insertBefore(lastClone, originals[0]);
      track.appendChild(firstClone);

      const items = () => Array.from(track.children); // clone 포함
      let index = 1;  // 첫 '진짜' 슬라이드
      let animating = false;

      // dots + thumbs 생성
      const dots = [];
      const thumbs = [];

      dotsWrap.innerHTML = "";
      thumbsWrap.innerHTML = "";

      for (let i = 0; i < N; i++) {
        // dots
        const d = document.createElement("button");
        d.type = "button";
        d.className = "dot" + (i === 0 ? " active" : "");
        d.setAttribute("aria-label", `슬라이드 ${i + 1}`);
        d.addEventListener("click", () => goTo(i + 1));
        dotsWrap.appendChild(d);
        dots.push(d);

        // thumbs
        const t = document.createElement("button");
        t.type = "button";
        t.className = "thumb" + (i === 0 ? " active" : "");
        t.setAttribute("aria-label", `썸네일 ${i + 1}`);
        t.innerHTML = `<img src="https://img.youtube.com/vi/${ids[i]}/hqdefault.jpg" alt="thumb ${i + 1}">`;
        t.addEventListener("click", () => goTo(i + 1));
        thumbsWrap.appendChild(t);
        thumbs.push(t);
      }

      const width = () => viewport.clientWidth;

      const setPos = (withAnim = true) => {
        track.style.transition = withAnim
          ? "transform 360ms cubic-bezier(.2,.9,.2,1)"
          : "none";
        track.style.transform = `translateX(${-width() * index}px)`;
      };

      const setActive = () => {
        const real = (index - 1 + N) % N;
        dots.forEach((d, i) => d.classList.toggle("active", i === real));
        thumbs.forEach((t, i) => t.classList.toggle("active", i === real));

        const activeThumb = thumbs[real];
        if (activeThumb) {
          activeThumb.scrollIntoView({ behavior: "smooth", block: "nearest", inline: "center" });
        }
      };

      const goTo = (nextIndex) => {
        if (animating) return;
        animating = true;
        index = nextIndex;
        setPos(true);
        setActive();
      };

      // 초기 위치
      setPos(false);
      setActive();

      // 버튼
      prevBtn.addEventListener("click", () => goTo(index - 1));
      nextBtn.addEventListener("click", () => goTo(index + 1));

      // transition 끝나면 clone 구간 순간이동
      track.addEventListener("transitionend", () => {
        const arr = items();
        if (arr[index] === firstClone) {
          index = 1; setPos(false);
        } else if (arr[index] === lastClone) {
          index = N; setPos(false);
        }
        animating = false;
        setActive();
      });

      // 리사이즈 대응
      window.addEventListener("resize", () => setPos(false));

      // 키보드
      window.addEventListener("keydown", (e) => {
        if (e.key === "ArrowLeft") goTo(index - 1);
        if (e.key === "ArrowRight") goTo(index + 1);
      });

      // 드래그/스와이프
      let startX = 0, dx = 0, dragging = false;

      const down = (x) => {
        if (animating) return;
        dragging = true;
        startX = x;
        dx = 0;
        track.style.transition = "none";
      };
      const move = (x) => {
        if (!dragging) return;
        dx = x - startX;
        track.style.transform = `translateX(${-width() * index + dx}px)`;
      };
      const up = () => {
        if (!dragging) return;
        dragging = false;
        const threshold = width() * 0.18;
        if (dx > threshold) goTo(index - 1);
        else if (dx < -threshold) goTo(index + 1);
        else { setPos(true); animating = false; setActive(); }
        dx = 0;
      };

      viewport.addEventListener("mousedown", (e) => down(e.clientX));
      window.addEventListener("mousemove", (e) => move(e.clientX));
      window.addEventListener("mouseup", up);

      viewport.addEventListener("touchstart", (e) => down(e.touches[0].clientX), { passive: true });
      viewport.addEventListener("touchmove", (e) => move(e.touches[0].clientX), { passive: true });
      viewport.addEventListener("touchend", up);

      // 자동 재생
      let timer = null;
      const stopAuto = () => { if (timer) clearInterval(timer); timer = null; };
      const startAuto = () => {
        stopAuto();
        const ms = parseInt(intervalEl.value, 10);
        timer = setInterval(() => goTo(index + 1), ms);
      };

      autoPlayEl.addEventListener("change", () => {
        if (autoPlayEl.checked) startAuto();
        else stopAuto();
      });

      intervalEl.addEventListener("change", () => {
        if (autoPlayEl.checked) startAuto();
      });
    });
  </script>
</body>
</html>
